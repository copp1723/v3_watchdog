# Manual Testing Guide for Enhanced Watchdog AI

This guide provides step-by-step instructions for manually testing the enhanced version of Watchdog AI, particularly focusing on the fixes for the "Error generating insight" issue.

## Prerequisites

1. Python 3.9+ installed
2. Git repository cloned locally
3. Virtual environment activated
4. Required dependencies installed:
   ```bash
   pip install -r requirements.txt
   ```

## Test Environment Setup

### 1. Mock Mode Testing

The mock mode allows testing without an API key:

```bash
# Make scripts executable
chmod +x setup_env.py apply_fixes.sh

# Configure mock mode
./setup_env.py --use-mock

# Apply fixes
./apply_fixes.sh
```

### 2. API Mode Testing

To test with real API calls:

```bash
# Configure with OpenAI API key
./setup_env.py --use-api --api-key YOUR_OPENAI_API_KEY --provider openai

# Alternatively, for Anthropic API
./setup_env.py --use-api --api-key YOUR_ANTHROPIC_API_KEY --provider anthropic

# Apply fixes
./apply_fixes.sh
```

## Test Cases

### Test Case 1: Basic File Upload and Processing

**Objective**: Verify file upload and processing works correctly.

**Steps**:
1. Run the enhanced app: `streamlit run src/app_enhanced.py`
2. Click the "Browse files" button in the Data Upload section
3. Select `test_data_complete.csv` from the project root
4. Check that the file uploads without errors
5. Verify a success toast appears: "Successfully processed 'test_data_complete.csv'"

**Expected Result**: File should upload successfully and be processed without errors.

### Test Case 2: Car Gurus Sales Insight Generation

**Objective**: Verify the fix for "Error generating insight" when querying about Car Gurus.

**Steps**:
1. Run the enhanced app: `streamlit run src/app_enhanced.py`
2. Upload `test_data_complete.csv`
3. In the "Ask About Your Data" section, enter: "how many totals sales did lead source car gurus produce?"
4. Click "Generate Insight" button

**Expected Result**: 
- An insight should be generated without errors
- The insight should include information about Car Gurus sales (2 sales totaling $4,800.50)
- The response should appear in the "Analysis History" section

### Test Case 3: Empty Query Handling

**Objective**: Verify robust handling of empty queries.

**Steps**:
1. Run the enhanced app: `streamlit run src/app_enhanced.py`
2. Upload `test_data_complete.csv`
3. Leave the query input empty
4. Click "Generate Insight" button

**Expected Result**: 
- The app should handle this gracefully without crashing
- Either prevent submission of empty query or show an appropriate error message

### Test Case 4: Suggestion Button Functionality

**Objective**: Verify suggestion buttons work correctly.

**Steps**:
1. Run the enhanced app: `streamlit run src/app_enhanced.py`
2. Upload `test_data_complete.csv`
3. Before entering any query, click one of the suggestion buttons (e.g., "What is the average gross profit per deal?")

**Expected Result**:
- The suggested query should appear in the input field
- The page should not show any errors
- The query should be ready to be submitted

### Test Case 5: Clear Functionality

**Objective**: Verify the Clear button functions correctly.

**Steps**:
1. Run the enhanced app: `streamlit run src/app_enhanced.py`
2. Upload `test_data_complete.csv`
3. Generate an insight
4. Click the "Clear" button

**Expected Result**: 
- The conversation history should be cleared
- The "Analysis History" section should no longer show any insights

### Test Case 6: Large File Handling

**Objective**: Verify the app handles larger files properly.

**Steps**:
1. Create a larger version of the test data (can be generated by duplicating rows)
2. Upload the larger file
3. Generate insights with various queries

**Expected Result**: 
- The app should handle the larger file without performance issues
- Insights should still generate correctly
- No memory errors should occur

### Test Case 7: Edge Case - Invalid Column Reference

**Objective**: Verify improved error handling for invalid column references.

**Steps**:
1. Upload `test_data_complete.csv`
2. Enter a query referencing a non-existent column: "what was the total sales for lead source XYZ?"
3. Click "Generate Insight"

**Expected Result**: 
- The app should handle this gracefully without crashing
- It should either indicate that the column doesn't exist or provide a "no data found" type response
- The error details should be available in the debug section if expanded

### Test Case 8: Mobile Responsiveness

**Objective**: Verify the enhanced app works well on mobile devices.

**Steps**:
1. Open the app on a mobile device or use browser developer tools to simulate mobile view
2. Test file upload, suggestion buttons, and insight generation
3. Check readability and usability of the interface

**Expected Result**: 
- All functionality should work correctly on mobile
- UI should be properly responsive without elements overlapping
- Text should be readable and buttons easily tappable

## Detailed Error Verification

When testing, pay specific attention to the debugging features:

1. Check browser console logs for any errors or warnings
2. If errors occur, expand the "Error Details (Debug)" section to view detailed error information
3. Verify that error messages are clear and helpful for troubleshooting

## Documentation of Results

For each test case, document:
1. Whether the test passed or failed
2. Any unexpected behavior
3. Screenshots of errors (if applicable)
4. Suggestions for further improvements

This documentation will help identify any remaining issues and provide a clear picture of the fix effectiveness.
